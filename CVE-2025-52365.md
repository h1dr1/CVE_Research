CVE-2025-52365.md 
# CVE-2025-52365: Remote Code Execution in `szc` (ccurtsinger/stabilizer)

## Summary
A Command Injection vulnerability in the `szc` script of the `ccurtsinger/stabilizer` repository allows for Remote Code Execution (RCE). The script fails to sanitize user-supplied arguments before passing them to the system shell via `os.system()`.

## Vulnerability Details
- **Vulnerability Type:** Command Injection (CWE-77)
- **Affected Component:** `szc` script
- **Vulnerable Code:** ```python
  # User input args.o and filenames are concatenated into a shell string
  cmd = 'gcc ' + args.o + '.s'
  os.system(cmd)
Impact: An attacker can execute arbitrary shell commands by providing crafted arguments (e.g., -o "out; touch /tmp/pwned") or filenames containing shell metacharacters.

Attack Scenarios
Local: A user is tricked into running szc on a malicious file.

CI/CD: An automated build process executes szc on untrusted input from a Pull Request, leading to environment compromise.

Network: If szc is wrapped in a web API, remote unauthenticated attackers can gain shell access to the host.

CVSS v3.1 Vector
Scenario: Network-based/Automated System

Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

Base Score: 9.8 (Critical)

Proof of Concept (PoC)
To reproduce the vulnerability, execute the following command:

Bash
./szc -o out "test.c; touch /tmp/pwned"
The existence of /tmp/pwned confirms that the touch command was executed by the shell through the szc wrapper.

Remediation
Short-term: Sanitize all user input to remove shell metacharacters.

Long-term: Replace os.system() with the subprocess module. Use a list of arguments instead of a single string to avoid shell interpretation:

Python
import subprocess
subprocess.run(["gcc", args.o + ".s"])
Credits
Discovered and reported by [Hidri Mohamed Aziz (@h1dr1)].
